\documentclass{snamc2013}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{graphicx}  % allows inclusion of graphics
\usepackage{booktabs}  % nice rules (thick lines) for tables
\usepackage{microtype} % improves typography for PDF
\usepackage[breaklinks=true,colorlinks=true,linkcolor=black,citecolor=black]{hyperref}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{A Multiple-Set Overlapping-Domain Decomposed Monte Carlo
  Synthetic Acceleration Method for Linear Systems}

\author[1]{Stuart R. Slattery}
\author[1]{Paul P.H. Wilson}
\author[2]{Thomas M. Evans}

\affil[1]{University of Wisconsin - Madison, Engineering Physics
  Department, 1500 Engineering Drive, Madison, WI 53706}
\affil[2]{Oak Ridge National Laboratory, One Bethel Valley Road, Oak
  Ridge, TN 37830}

\abstract{We present a novel multiple-set overlapping-domain
  decomposed strategy for parallelizing the Monte Carlo Synthetic
  Acceleration (MCSA) method. MCSA methods use the Neumann-Ulam class
  of Monte Carlo solvers for linear systems to accelerate the fixed
  point method upon which the Neumann-Ulam solvers are based. To
  effectively parallelize MCSA methods requires the parallelization of
  the underlying Neumann-Ulam solvers. To do this in a domain
  decomposed environment, we borrow strategies traditionally
  implemented in particle transport Monte Carlo to parallelize the
  problem. The multiple-set overlapping-domain decomposition algorithm
  will be presented in the submission along with parallel scaling data
  for the resulting implementation.}

\keywords{MCSA, Monte Carlo, domain decomposition, linear solvers,
  parallel computing}

\begin{document}

%%---------------------------------------------------------------------------%%
\section{Introduction}

For some time, the particle transport community has been utilizing
Monte Carlo methods for the solution of transport problems
\cite{lewis_computational_1993}. The partial differential equation
(PDE) community has focused on various deterministic methods for
solutions to linear problems \cite{saad_iterative_2003}. In between
these two areas are a not widely known group of Monte Carlo methods
for solving sparse linear systems \cite{forsythe_matrix_1950,
  hammersley_monte_1964, halton_sequential_1962,
  halton_sequential_1994}. In recent years, these methods have been
further developed for radiation transport problems in the form of
Monte Carlo Synthetic-Acceleration (MCSA) \cite{evans_monte_2009,
  evans_monte_2012} but have yet to be applied to more general sparse
linear systems commonly generated by the computational physics
community. Compared to other methods in this regime, MCSA offers three
attractive qualities; (1) the linear problem operator need not be
symmetric or positive-definite, thereby reducing preconditioning
complexity, (2) the stochastic nature of the solution method provides
a natural solution to the issue of resiliency, and (3) is amenable to
parallelization using modern methods developed by the transport
community \cite{wagner_hybrid_2010}. The development of MCSA as a
general linear solver and the development of a parallel MCSA method
will be new and unique features of this work, providing a framework
with which other issues such as resiliency may be addressed in the
future.

As leadership class machines move towards the exascale, new algorithms
must be developed that leverage their strengths and adapt to their
shortcomings. Looking towards machines operating at hundreds of
petaflops peak performance and beyond, trends toward reduced energy
consumption will require incredibly high levels of concurrency to
achieve the desired computation rates \cite{kogge_using_2011}. The end
result of these hardware changes is that the larger numbers of
low-powered processors will be prone to both soft and hard failures
such as bit errors in floating point operations and hard failures with
resilient solver technologies are required to overcome these
events. With linear solvers based on Monte Carlo techniques, such
issues are alleviated by statistical arguments. In the case of soft
failures, isolated floating point errors in Monte Carlo simulation are
absorbed within tally statistics while completely losing hardware
during a hard failure is manifested as a high variance event where
some portion of the Monte Carlo histories are lost.

%%---------------------------------------------------------------------------%%
\section{Monte Carlo Synthetic Acceleration}

An alternative approach to approximate matrix inversion is to employ
Monte Carlo methods that sample a distribution with an expectation
value equivalent to that of the inverted operator. Such methods have
been in existence for decades with the earliest reference noted here
an enjoyable manuscript published in 1950 by Forsythe and Leibler
\cite{forsythe_matrix_1950}. In their outline, Forsythe and Liebler in
fact credit the creation of this technique to J. Von Neumann and
S.M. Ulam some years earlier than its publication. Hammersley and
Handscomb's 1964 monograph \cite{hammersley_monte_1964} and Spanier
and Gelbard's 1969 book \cite{spanier_monte_1969} present additional
detail on this topic using a collection of references from the 1950's
and early 1960's.

Using the ideas of Halton's residual method
\cite{halton_sequential_1994}, Evans and Mosher recently developed a
Monte Carlo solution method that was not prohibited severely by the
quality of the initial guess for the system \cite{evans_monte_2009}
and later applied it more rigorously as a solution mechanism for the
radiation diffusion equation \cite{evans_monte_2012}. With their new
methods, they achieved identical numerical results as and marginally
better performance than conventional Krylov solvers. Their approach
was instead to use residual Monte Carlo as a synthetic acceleration
for a stationary method. Using Monte Carlo in this way achieves the
same effect as Halton's method, decoupling its convergence rate from
the overall convergence rate of the method. Here, the approximate
Monte Carlo solution is not driven to a particular convergence as it
merely supplies a correction for the initial guess generated by
Richardson's iteration. Rather, only a set number of histories are
required using the adjoint method to generate the correction.

%%---------------------------------------------------------------------------%%
\section{Multiple-Set Overlapping-Domain Decomposition}

Current implementations of parallel Neumann-Ulam methods have been
limited to full domain replication with parallelism exploited through
individual histories \cite{alexandrov_efficient_1998}. For high
performance computing environments, domain decomposition strategies
have been identified as important for Monte Carlo applications
\cite{brunner_comparison_2006,siegel_analysis_2012}. In a domain
decomposed Monte Carlo implementation, stochastic histories must be
communicated between domains as the simulation progresses and they
transition to locations outside of the local domain. In order to
implement domain decomposition strategy for Monte Carlo solvers in a
parallel environment, communication of these histories must occur
between compute nodes owning neighboring pieces of the global domain.

At the 2010 SNA+MC meeting, Wagner and colleagues developed the
\textit{multiple-set overlapping-domain} (MSOD) decomposition for
parallel Monte Carlo applications for full-core light water reactor
analysis \cite{wagner_hybrid_2010}. In their work, overlap between
adjacent domains in the decomposition was used to decrease the number
of particles leaving the local domain. In addition, Wagner utilized a
level of replication of the domain such that the domain was only
decomposed on $O(100)$ processors and if replicated $O(1,000)$ times
achieves simulation on $O(100,000)$ processors, thus providing spatial
and particle parallelism. Each collection of processors that
constitutes a representation of the entire domain is referred to as a
set, and within a set overlap occurs among its sub-domains. The
original motivation was to decompose the domain in a way that it
remained in a physical cabinet in a large distributed machine, thus
reducing latency costs during communication. A multiple set scheme is
also motivated by the fact that communication during particle
transport only occurs within a set, limiting communications during the
transport procedure to a group of $O(100)$ processors, a number that
was shown to have excellent parallel efficiencies in Brunner's work
\cite{brunner_efficient_2009} and therefore will scale well in this
algorithm. The overlapping domains within each set also demonstrated
reduced communication costs.

%%---------------------------------------------------------------------------%%
\section{Submission Outline}

With our submission we will present a multiple-set overlapping-domain
decomposed implementation of the Monte Carlo Synthetic Acceleration
method. This presentation will include an outline of the Neumann-Ulam
and MCSA methods followed by a presentation of the MSOD scheme as
implemented for MCSA. This implementation will be tested and the
results of parallel scaling studies presented that demonstrate the
achieved parallel performance.

%%---------------------------------------------------------------------------%%
\bibliographystyle{ans}
\bibliography{references}
\end{document}
